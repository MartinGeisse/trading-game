<html>
<head>
    <style type="text/css">

        html, body, #map {
            margin: 0;
            padding: 0;
        }

        html, body {
            width: 100%;
            height: 100%;
        }

        #map {
            display: block;
        }

    </style>
    <script type="text/javascript" src="jquery-3.2.1.js"></script>
    <script type="text/javascript" src="jquery.mousewheel.js"></script>
    <script type="text/javascript" src="general.js"></script>
    <script type="text/javascript" src="map.js"></script>
    <script type="text/javascript">
        $(function() {

            //
            // create the map
            //

            map = new AwesomeMap.Map($('#map')[0]);
            map.layers[0] = new AwesomeMap.Layer();
            map.installResizer(function(canvas) {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });


            //
            // zooming
            //

            (function() {

                $('#map').on('mousewheel', function(event) {
                    var factor = Math.exp(event.deltaY * event.deltaFactor / 1000);
                    map.viewport.zoomAtPixelPosition(event.pageX, event.pageY, factor);
                });

            })();


            //
            // panning
            //

            (function() {

                $('#map').awesomeDrag(function(dx, dy) {
                    map.viewport.panByPixelAmount(dx, dy);
                });


                $('#map').on('contextmenu', function(event) {
                    // TODO
                    // var $element = $(document.createElementNS("http://www.w3.org/2000/svg", "circle"));
                    // $element.attr('cx', event.pageX / map.viewport.zoom - map.viewport.mapOriginX);
                    // $element.attr('cy', event.pageY / map.viewport.zoom - map.viewport.mapOriginY);
                    // $element.attr('r', '40');
                    // $element.attr('stroke', 'blue');
                    // $element.attr('stroke-width', '3');
                    // $element.attr('fill', 'red');
                    // $('#map-panning-group').append($element);
                    return false;
                });

            })();


            //
            // initialization
            //

            for (i=0; i<10000; i++) {
                map.layers[0].objects.push({
                    x: Math.random() * 100000 - 50000,
                    y: Math.random() * 100000 - 50000,
                    r: Math.random() * 50 + 10
                });
            }
            map.render();

        });
    </script>
</head>
<body>
    <canvas id="map"></canvas>
</body>
</html>